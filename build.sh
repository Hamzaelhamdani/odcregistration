#!/bin/bash#!/bin/bash

# build.sh - Script de build pour Netlify# build.sh - Build script for Netlify

# This script injects environment variables into env.js at build time

set -e

set -e  # Exit on error

echo "ğŸ”§ GÃ©nÃ©ration de env.js..."

echo "ğŸ”§ Starting build process..."

# VÃ©rifier que les variables sont dÃ©finies

if [ -z "$SUPABASE_URL" ] || [ -z "$SUPABASE_ANON_KEY" ]; then# Check if environment variables are set

    echo "âŒ Erreur: Variables SUPABASE_URL et SUPABASE_ANON_KEY manquantes"if [ -z "$SUPABASE_URL" ] || [ -z "$SUPABASE_ANON_KEY" ]; then

    exit 1    echo "âŒ Error: SUPABASE_URL and SUPABASE_ANON_KEY must be set in Netlify environment variables"

fi    exit 1

fi

# GÃ©nÃ©rer env.js depuis le template

cat > env.js << EOFecho "ğŸ“ Generating env.js with environment variables..."

(function() {

    "use strict";# Create env.js directly with the environment variables

    window.ENV = {cat > env.js << EOF

        SUPABASE_URL: '$SUPABASE_URL',/*

        SUPABASE_ANON_KEY: '$SUPABASE_ANON_KEY' * env.js - Generated by build script

    }; * DO NOT EDIT MANUALLY - This file is auto-generated during deployment

    console.log('ğŸ”§ Configuration Supabase chargÃ©e:', { */

        url: window.ENV.SUPABASE_URL,

        hasKey: !!window.ENV.SUPABASE_ANON_KEY(function() {

    });    "use strict";

})();

EOF    // Variables d'environnement injectÃ©es pendant le build

    window.ENV = {

echo "âœ… env.js gÃ©nÃ©rÃ© avec succÃ¨s"        SUPABASE_URL: '$SUPABASE_URL',

        SUPABASE_ANON_KEY: '$SUPABASE_ANON_KEY'
    };

    // Helpful debug output (doesn't print the key value)
    console.log('ğŸ”§ Variables d\'environnement chargÃ©es:', {
        url: window.ENV.SUPABASE_URL,
        hasKey: !!window.ENV.SUPABASE_ANON_KEY
    });
})();
EOF

echo "âœ… env.js generated successfully"
echo "âœ… Build completed"
